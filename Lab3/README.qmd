---
title: "Основы обработки данных с помощью R и Dplyr"
author: "aleksandr.zwonov@yandex.ru"
format: 
  md:
    output-file: README.md
editor: visual
---

## Цель работы

1.  Развить практические навыки использования языка программирования R для обработки данных
2.  Закрепить знания базовых типов данных языка R
3.  Развить практические навыки использования функций обработки данных пакета `dplyr` – функции `select(), filter(), mutate(), arrange(), group_by()`

## Исходные данные

1.  Программное обеспечение Windows 10 Pro
2.  Rstudio Desktop
3.  Интерпретатор языка R 4.5.1

## Задание

Проанализировать встроенные в пакет nycflights13 наборы данных с помощью языка R и ответить на вопросы.

### Шаги

#### Установим и подключим пакеты

```{r}
library(nycflights13)
```

```{r}
library(dplyr)
```

#### Проанализируем встроенные в пакет nycflights13 наборы данных

1\.  Сколько встроенных в пакет nycflights13 датафреймов?

```{r}
data(package = "nycflights13")$results[, "Item"]

length(data(package = "nycflights13")$results[, "Item"])
```

2\.  Сколько строк в каждом датафрейме?

```{r}
airlines |> nrow()
```

```{r}
airports |> nrow()
```

```{r}
flights |> nrow()
```

```{r}
planes |> nrow()
```

```{r}
weather |> nrow()
```

3\.  Сколько столбцов в каждом датафрейме?

```{r}
airlines |> ncol()
```

```{r}
airports |> ncol()
```

```{r}
flights |> ncol()
```

```{r}
planes |> ncol()
```

```{r}
weather |> ncol()
```

4\.  Как просмотреть примерный вид датафрейма?

```{r}
airlines |> glimpse()
```

5\.  Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?

```{r}
airlines |> select(carrier) |> unique() |> count()
```

6\.  Сколько рейсов принял аэропорт John F Kennedy Intl в мае?

```{r}
left_join(flights, airports, by = c("origin"="faa")) |> filter(name == "John F Kennedy Intl" & month == 5) |> count()
```

7\.  Какой самый северный аэропорт?

```{r}
arrange(airports, desc(lon)) |> select(name) |>  head(1)
```

8\.  Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?

```{r}
arrange(airports, desc(alt)) |> select(name) |>  head(1)
```

9\.  Какие бортовые номера у самых старых самолетов?

```{r}
arrange(planes, year) |> select(tailnum) |> head()
```

10\. Какая средняя температура воздуха была в сентябре в аэропорту John F Kennedy Intl (в градусах Цельсия).

```{r}
left_join(weather, airports, by=c("origin"="faa")) |> filter(name == "John F Kennedy Intl" & month == 9) |> summarise(mean_temp = (mean(temp)- 32) / 1.8)
```

11\. Самолеты какой авиакомпании совершили больше всего вылетов в июне?

```{r}
left_join(flights, airlines, join_by(carrier)) |> filter(month == 6) |> group_by(name) |> summarise(amount = n()) |> arrange(desc(amount)) |> head(1) |> select(name)
```

12\. Самолеты какой авиакомпании задерживались чаще других в 2013 году?

```{r}
left_join(flights, airlines, join_by(carrier)) |> group_by(name) |> filter( arr_delay > 0 & year == 2013) |> group_by(name) |> summarise(n = n()) |> arrange(desc(n)) |> select(name) |> head(1)
```

## Вывод

В ходе работы были проанализированы встроенные в пакет nycflights13 наборы данных и улучшены практические навыки использования языка программирования R.
